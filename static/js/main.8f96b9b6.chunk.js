(this["webpackJsonpsf-hq"]=this["webpackJsonpsf-hq"]||[]).push([[0],{17:function(t,e,n){},23:function(t,e,n){t.exports=n.p+"static/media/githubLogo.30b150cd.png"},24:function(t,e,n){t.exports=n(39)},39:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),c=n(19),s=n.n(c),o=n(11),i=n(3),u=n(2),l=n.n(u),f=n(5),m=n(8),p=function(t){return localStorage.getItem(t)},d=function(t,e){return localStorage.setItem(t,e)},h=function(t){return localStorage.removeItem(t)},g=function(t){return function(e){return r.a.createElement(t,Object.assign({},e,{persistence:{get:p,set:d,remove:h}}))}},b=g((function(t){var e=t.width,n=void 0===e?"200":e,a=t.height,c=void 0===a?"100vh":a,s=t.children,o=t.persistence,i=r.a.useState(o.get("sidebar")||-n),u=Object(m.a)(i,2),l=u[0],f=u[1];return r.a.useEffect((function(){o.set("sidebar",l)}),[l]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"side-bar",style:{transform:"translatex(".concat(l,"px)"),width:n,minHeight:c}},r.a.createElement("button",{onClick:function(){f(l<0?0:-n)},className:"toggle-menu",style:{transform:"translate(".concat(n,"px, 20vh)")}}),r.a.createElement("div",{className:"content"},s)))})),v=n(20),k=n(21),w=new(function(){function t(e){var n=this,a=e.token,r=e.baseUrl,c=void 0===r?"https://api.github.com":r;Object(v.a)(this,t),this.setToken=function(t){n.token=t},this.fetch=function(){var t=Object(f.a)(l.a.mark((function t(e){var a,r,c=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=c.length>1&&void 0!==c[1]?c[1]:{}).headers||(a.headers={}),a.headers.Authorization="token ".concat(n.token),t.next=5,fetch(e,a);case 5:if((r=t.sent).ok){t.next=12;break}return t.t0=Error,t.next=10,r.json();case 10:throw t.t1=t.sent,new t.t0(t.t1);case 12:return t.abrupt("return",r.json());case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.token=a,this.baseUrl=c}return Object(k.a)(t,[{key:"listOrganizations",value:function(){return this.fetch("".concat(this.baseUrl,"/user/orgs"))}},{key:"listTeams",value:function(){var t=Object(f.a)(l.a.mark((function t(e){var n,a=this;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetch("".concat(this.baseUrl,"/orgs/").concat(e,"/teams"));case 2:return n=t.sent,t.abrupt("return",Promise.all(n.map(function(){var t=Object(f.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.fetch(n.repositories_url);case 2:return n.repositories=t.sent,t.next=5,Promise.all(n.repositories.map(function(){var t=Object(f.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.fetch("".concat(a.baseUrl,"/repos/").concat(e,"/").concat(n.name,"/milestones"));case 2:return n.milestones=t.sent,t.next=5,Promise.all(n.milestones.map(function(){var t=Object(f.a)(l.a.mark((function t(r){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.fetch("".concat(a.baseUrl,"/repos/").concat(e,"/").concat(n.name,"/issues?milestone=").concat(r.number,"&state=all"));case 2:return r.issues=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 5:return n.milestones=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 5:return n.repositories=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())));case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}())({token:localStorage.getItem("access_token")}),_=function(t){return g((function(e){var n=Object(a.useState)(!1),c=Object(m.a)(n,2),s=c[0],o=c[1];return Object(a.useEffect)((function(){(function(){var t=Object(f.a)(l.a.mark((function t(){var n,a,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.location.search){t.next=19;break}return t.next=3,fetch("https://wtrc7fvnyd.execute-api.eu-west-1.amazonaws.com/Prod/auth/",{method:"POST",body:JSON.stringify({code:new URLSearchParams(window.location.search).get("code"),state:Math.random()})});case 3:if(!(n=t.sent).ok){t.next=13;break}return t.next=7,n.json();case 7:a=t.sent,r=a.access_token,e.persistence.set("access_token",r),window.location.href="/sf-hq",t.next=19;break;case 13:return t.t0=console,t.next=16,n.json();case 16:t.t1=t.sent,t.t0.error.call(t.t0,t.t1),o(!0);case 19:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]),s?r.a.createElement("span",null,"Error while fetching GitHub access token using code"):r.a.createElement(t,Object.assign({},e,{sdk:w}))}))},E=(n(17),n(1)),x=(n(30),E.gantt.date.date_to_str(E.gantt.config.task_date)),j=function(t){var e=t.tasks,n=Object(a.useRef)();return Object(a.useEffect)((function(){var t={levels:[{name:"day",scale_height:27,min_column_width:80,scales:[{unit:"day",step:1,format:"%d %M"}]},{name:"week",scale_height:50,min_column_width:50,scales:[{unit:"week",step:1,format:function(t){var e=E.gantt.date.date_to_str("%d %M"),n=E.gantt.date.add(t,-6,"day");return"#"+E.gantt.date.date_to_str("%W")(t)+", "+e(t)+" - "+e(n)}},{unit:"day",step:1,format:"%j %D"}]},{name:"month",scale_height:50,min_column_width:120,scales:[{unit:"month",format:"%F, %Y"},{unit:"week",format:"Week #%W"}]},{name:"quarter",height:50,min_column_width:90,scales:[{unit:"month",step:1,format:"%M"},{unit:"quarter",step:1,format:function(t){var e=E.gantt.date.date_to_str("%M"),n=E.gantt.date.add(E.gantt.date.add(t,3,"month"),-1,"day");return e(t)+" - "+e(n)}}]},{name:"year",scale_height:50,min_column_width:30,scales:[{unit:"year",step:1,format:"%Y"}]}]};E.gantt.ext.zoom.init(t),E.gantt.config.readonly=!0,E.gantt.config.columns=[{name:"text",label:"Resource",width:"*",tree:!0}],E.gantt.templates.task_text=function(t,e,n){var a="";return n.title&&(a+=n.title),n.percentage&&(a+=" (".concat(Math.round(100*n.progress),"%)")),a},E.gantt.plugins({tooltip:!0,marker:!0}),E.gantt.addMarker({start_date:new Date,css:"today",text:"Now",title:x(new Date)}),E.gantt.init(n),E.gantt.parse({data:e})}),[]),Object(a.useEffect)((function(){E.gantt.clearAll(),E.gantt.addMarker({start_date:new Date,css:"today",text:"Now",title:x(new Date)}),E.gantt.parse({data:e}),E.gantt.render()}),[e]),r.a.createElement("div",{ref:function(t){n=t},style:{width:"100%",height:"100%"}})},O=(n(31),function(){var t=Object(f.a)(l.a.mark((function t(e){var n,a,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.sdk,a=e.organization,t.next=3,n.listTeams(a);case 3:return r=t.sent,t.abrupt("return",r.reduce((function(t,e){if(!e.repositories.some((function(t){return t.milestones&&t.milestones.length})))return t;var n={id:e.id,title:e.name,text:'<a href="'.concat(e.html_url,'" target="_blank">').concat(e.name,"</a>"),type:E.gantt.config.types.project,color:"#f1f8ff",textColor:"black",open:!0};return t.push(n),e.repositories&&e.repositories.forEach((function(n){if(n.milestones&&n.milestones.length){var a={id:n.id,parent:e.id,title:n.name,text:'<a href="'.concat(n.html_url,'" target="_blank">').concat(n.name,"</a>"),type:E.gantt.config.types.project,color:"#fff3a1",textColor:"black",open:!0};t.push(a),n.milestones.forEach((function(e){var a=1-e.open_issues/(e.open_issues+e.closed_issues),r=new Date(e.due_on),c={id:e.id,parent:n.id,title:"#".concat(e.number," ").concat(e.title),text:'<a href="'.concat(e.html_url,'" target="_blank">#').concat(e.number," ").concat(e.title,"</a"),start_date:new Date(e.created_at),end_date:r,type:E.gantt.config.types.task,progress:a,percentage:!0,color:e.closed_at?"#46ad51":Date.now()>r?"#d81b1b":"#46ad51",open:!0};t.push(c),e.issues&&e.issues.forEach((function(n){if(!n.pull_request&&!n.labels.find((function(t){return"documentation"===t.name}))){var a={id:n.id,parent:e.id,title:"#".concat(n.number," ").concat(n.title),text:"\n                    ".concat(n.assignee?'\n                      <a href="'.concat(n.assignee.html_url,'" target="_blank">\n                        <img src="').concat(n.assignee.avatar_url,'" alt="').concat(n.assignee.login,'" class="thumb">\n                      </a>'):"",'\n                      <a href="').concat(n.html_url,'" target="_blank">#').concat(n.number," ").concat(n.title,"</a>\n                  "),start_date:new Date(n.created_at),end_date:n.closed_at?new Date(n.closed_at):r,color:n.closed_at?"#1b668a9e":"#1b668a",open:!0,type:E.gantt.config.types.task};t.push(a)}}))}))}})),t}),[]));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),y=g(_((function(t){var e=t.persistence,n=t.organization,c=t.sdk,s=Object(a.useState)(!1),o=Object(m.a)(s,2),i=o[0],u=o[1],p=Object(a.useState)(!1),d=Object(m.a)(p,2),h=d[0],g=d[1],b=Object(a.useState)([]),v=Object(m.a)(b,2),k=v[0],w=v[1];return Object(a.useEffect)((function(){(function(){var t=Object(f.a)(l.a.mark((function t(n){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.get("access_token")){t.next=2;break}return t.abrupt("return",g(!0));case 2:return u(!0),t.prev=3,t.next=6,O({sdk:c,organization:n});case 6:a=t.sent,w(a),g(!1),u(!1),t.next=17;break;case 12:t.prev=12,t.t0=t.catch(3),w([]),g(!0),u(!1);case 17:case"end":return t.stop()}}),t,null,[[3,12]])})));return function(e){return t.apply(this,arguments)}})()(n)}),[n]),E.gantt.attachEvent("onTaskClosed",(function(t){e.set(t,"closed")})),E.gantt.attachEvent("onTaskOpened",(function(t){e.remove(t)})),E.gantt.attachEvent("onParse",(function(){E.gantt.eachTask((function(t){"closed"===e.get(t.id)&&(t.$open=!1)}))})),h?r.a.createElement("span",null,"Error while fetching data from GitHub"):i?r.a.createElement("span",null,"Loading..."):r.a.createElement("div",{className:"milestones"},r.a.createElement("div",{className:"gantt-container"},k&&r.a.createElement(j,{tasks:k,zoom:"Months"})))}))),z=g(_(Object(i.g)((function(t){var e=t.sdk,n=t.match,c=t.persistence,s=Object(a.useState)([]),u=Object(m.a)(s,2),p=u[0],d=u[1];return Object(a.useEffect)((function(){var t=function(){var t=Object(f.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.listOrganizations();case 2:n=t.sent,d(n);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();c.get("access_token")&&t()}),[]),c.get("access_token")?r.a.createElement("div",{className:"organization-gantt"},r.a.createElement(b,null,r.a.createElement("h3",null,"Organizations"),r.a.createElement("ul",null,p.map((function(t,e){return r.a.createElement("li",{key:e},r.a.createElement("img",{src:t.avatar_url,width:30}),r.a.createElement(o.b,{to:"/gantt/".concat(t.login)},t.login))}))),r.a.createElement("h3",null,"Filters")),r.a.createElement(y,{organization:n.params.organization})):r.a.createElement(i.a,{to:"/"})})))),S=function(t){t.sdk;return r.a.createElement("div",{className:"app"},"wiki")},N=n(23),D=n.n(N),M=g(_((function(t){var e=Object(a.useState)([]),n=Object(m.a)(e,2),c=n[0],s=n[1];return Object(a.useEffect)((function(){var e=function(){var e=Object(f.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.sdk.listOrganizations();case 2:n=e.sent,s(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t.persistence.get("access_token")&&e()}),[]),t.persistence.get("access_token")?r.a.createElement("div",{className:"home"},r.a.createElement("ul",null,c.map((function(t){return r.a.createElement("li",null,r.a.createElement(o.b,{to:"/gantt/".concat(t.login)},t.login," "))})))):r.a.createElement("a",{href:"https://github.com/login/oauth/authorize?client_id=".concat("3a4d6f71dcd5a9385017","&redirect_uri=").concat("https://soluzionifutura.github.io/sf-hq","&scope=admin:org repo")},r.a.createElement("img",{width:"100px",height:"100px",src:D.a}))}))),q=function(){return r.a.createElement(o.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/",component:M}),r.a.createElement(i.b,{exact:!0,path:"/gantt/:organization",component:z}),r.a.createElement(i.b,{path:"/wiki",render:S})))};n(37),s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(q,null)),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.8f96b9b6.chunk.js.map